(* Content-type: application/vnd.wolfram.mathematica *)

(*** Wolfram Notebook File ***)
(* http://www.wolfram.com/nb *)

(* CreatedBy='Mathematica 13.3' *)

(*CacheID: 234*)
(* Internal cache information:
NotebookFileLineBreakTest
NotebookFileLineBreakTest
NotebookDataPosition[       158,          7]
NotebookDataLength[     25738,        740]
NotebookOptionsPosition[     22969,        684]
NotebookOutlinePosition[     23364,        700]
CellTagsIndexPosition[     23321,        697]
WindowFrame->Normal*)

(* Beginning of Notebook Content *)
Notebook[{

Cell[CellGroupData[{
Cell[BoxData[
 RowBox[{"CNOTLSB", "=", 
  RowBox[{"{", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
    RowBox[{"{", 
     RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]}], "}"}]}]], "Input",
 CellLabel->
  "In[113]:=",ExpressionUUID->"34db9da3-983b-4a94-a6c3-df907fe63086"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", "1"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "1", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "1", ",", "0", ",", "0"}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{3.9620686641489773`*^9},
 CellLabel->
  "Out[113]=",ExpressionUUID->"311efff5-65a3-451c-b2e4-a408cca13414"]
}, Open  ]],

Cell[BoxData[{
 RowBox[{
  RowBox[{"H", "=", 
   RowBox[{
    RowBox[{"1", "/", 
     RowBox[{"Sqrt", "[", "2", "]"}]}], " ", 
    RowBox[{"{", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"1", ",", "1"}], "}"}], ",", 
      RowBox[{"{", 
       RowBox[{"1", ",", 
        RowBox[{"-", "1"}]}], "}"}]}], "}"}]}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"H2", " ", "=", " ", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", "H"}], "]"}]}], 
  ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"ketp", " ", "=", " ", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{"1", ",", "1"}], "}"}], "/", 
    RowBox[{"Sqrt", "[", "2", "]"}]}]}], ";"}], "\[IndentingNewLine]", 
 RowBox[{
  RowBox[{"X1", " ", "=", " ", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", 
     RowBox[{"PauliMatrix", "[", "1", "]"}]}], "]"}]}], ";", 
  RowBox[{"Y1", "=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", 
     RowBox[{"PauliMatrix", "[", "2", "]"}]}], "]"}]}], ";", 
  RowBox[{"Z1", "=", 
   RowBox[{"KroneckerProduct", "[", 
    RowBox[{
     RowBox[{"IdentityMatrix", "[", "2", "]"}], ",", 
     RowBox[{"PauliMatrix", "[", "3", "]"}]}], "]"}]}], ";"}]}], "Input",
 CellChangeTimes->{{3.962068489555737*^9, 3.962068512825179*^9}, 
   3.9620685474920473`*^9, {3.962068617806107*^9, 3.9620686468991337`*^9}, {
   3.962085054735921*^9, 3.962085128287904*^9}},
 CellLabel->
  "In[148]:=",ExpressionUUID->"5b37f87b-29c9-4f11-90d5-867613f30bea"],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.96206854025766*^9, 
  3.962068545140904*^9}},ExpressionUUID->"888a22e9-30b3-425e-b831-\
5158efb370c7"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"diag", " ", "=", " ", 
  RowBox[{"DiagonalMatrix", "[", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"-", "I"}], " ", 
       RowBox[{"Pi", "/", "4"}]}], "]"}], ",", 
     RowBox[{"Exp", "[", 
      RowBox[{"I", " ", 
       RowBox[{"Pi", "/", "4"}]}], "]"}], ",", 
     RowBox[{"-", 
      RowBox[{"Exp", "[", 
       RowBox[{"I", " ", 
        RowBox[{"Pi", "/", "4"}]}], "]"}]}], ",", 
     RowBox[{"Exp", "[", 
      RowBox[{
       RowBox[{"I", " ", 
        RowBox[{"Pi", "/", "4"}]}], " ", "+", " ", 
       RowBox[{"I", " ", "\[Theta]"}]}], "]"}]}], "}"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9620685495750437`*^9, 3.962068585735105*^9}, {
  3.962068705986764*^9, 3.962068771993012*^9}},
 CellLabel->
  "In[228]:=",ExpressionUUID->"006785a4-40f8-46b0-8089-6127000fdfc3"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"-", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]}]], ",", "0", ",", "0", 
     ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", 
     SuperscriptBox["\[ExponentialE]", 
      FractionBox[
       RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]], ",", "0", ",", "0"}], 
    "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"-", 
      SuperscriptBox["\[ExponentialE]", 
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"]]}], ",", "0"}], "}"}], 
   ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{
       FractionBox[
        RowBox[{"\[ImaginaryI]", " ", "\[Pi]"}], "4"], "+", 
       RowBox[{"\[ImaginaryI]", " ", "\[Theta]"}]}]]}], "}"}]}], 
  "}"}]], "Output",
 CellChangeTimes->{{3.962068565009057*^9, 3.962068586228631*^9}, 
   3.962068772590665*^9, 3.962085198364592*^9, {3.9620859817888412`*^9, 
   3.962085990915145*^9}},
 CellLabel->
  "Out[228]=",ExpressionUUID->"f89f10c9-3f8e-436c-872f-b556eb0e0e34"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"diagBell", " ", "=", " ", 
  RowBox[{"DiagonalMatrix", "[", 
   RowBox[{"Exp", "[", 
    RowBox[{"2", "*", "Pi", "*", "I", "*", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", "1", ",", "1", ",", "2"}], "}"}], "/", "4"}]}], 
    "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.962085222034371*^9, 3.9620852715424337`*^9}, {
  3.962085475958684*^9, 3.962085478746853*^9}, {3.962085594412116*^9, 
  3.962085596233635*^9}, {3.962085633156893*^9, 3.9620856333465433`*^9}, {
  3.9620857079736223`*^9, 3.962085708558563*^9}},
 CellLabel->
  "In[203]:=",ExpressionUUID->"529f298b-2b0c-4db1-a761-a26d019a3a9a"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "\[ImaginaryI]", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "\[ImaginaryI]", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     RowBox[{"-", "1"}]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{
  3.9620852722337627`*^9, {3.962085486806321*^9, 3.962085501004773*^9}, 
   3.962085596658128*^9, 3.962085634326522*^9, 3.962085709314022*^9},
 CellLabel->
  "Out[203]=",ExpressionUUID->"51055a5c-2e7d-442e-8a72-5294d9de940e"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"diagEJM", " ", "=", " ", 
  RowBox[{"DiagonalMatrix", "[", 
   RowBox[{"Exp", "[", 
    RowBox[{"2", "*", "Pi", "*", "I", "*", 
     RowBox[{
      RowBox[{"{", 
       RowBox[{"0", ",", 
        RowBox[{"2", "^", 
         RowBox[{"(", 
          RowBox[{"n", "-", "2"}], ")"}]}], ",", 
        RowBox[{"-", 
         RowBox[{"2", "^", 
          RowBox[{"(", 
           RowBox[{"n", "-", "2"}], ")"}]}]}], ",", "1"}], "}"}], "/", 
      RowBox[{"2", "^", "n"}]}]}], "]"}], "]"}]}]], "Input",
 CellChangeTimes->{{3.9620861025269547`*^9, 3.962086113556119*^9}, {
  3.962086147585209*^9, 3.9620862573494043`*^9}, {3.962086355509221*^9, 
  3.962086363636053*^9}, {3.9620864112134733`*^9, 3.962086494537127*^9}, {
  3.962086874277298*^9, 3.962086909440398*^9}},
 CellLabel->
  "In[266]:=",ExpressionUUID->"7a1f70d3-b2cc-4006-9c11-15a399f1dd6d"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{"1", ",", "0", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "\[ImaginaryI]", ",", "0", ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", 
     RowBox[{"-", "\[ImaginaryI]"}], ",", "0"}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"0", ",", "0", ",", "0", ",", 
     SuperscriptBox["\[ExponentialE]", 
      RowBox[{"\[ImaginaryI]", " ", 
       SuperscriptBox["2", 
        RowBox[{"1", "-", "n"}]], " ", "\[Pi]"}]]}], "}"}]}], "}"}]], "Output",\

 CellChangeTimes->{{3.962086104186619*^9, 3.9620861142651443`*^9}, {
  3.962086471954835*^9, 3.962086495047494*^9}, {3.962086898903728*^9, 
  3.962086909938583*^9}},
 CellLabel->
  "Out[266]=",ExpressionUUID->"c8713d5c-a381-415d-b177-0241db33a0f4"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"\[IndentingNewLine]", 
  RowBox[{"psi", " ", "=", 
   RowBox[{
    RowBox[{"CNOTLSB", ".", "H2", ".", "diagEJM", ".", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"Flatten", "[", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"ketp", ",", "ketp"}], "]"}], "]"}], "}"}], "]"}]}], "//", 
    "Simplify"}]}]}]], "Input",
 CellChangeTimes->{{3.96206859580129*^9, 3.962068615911091*^9}, {
  3.962068650246352*^9, 3.9620686696448517`*^9}, {3.9620687826720467`*^9, 
  3.96206878403471*^9}, {3.962082833884532*^9, 3.962082852195529*^9}, {
  3.962082921122142*^9, 3.962082922985165*^9}, {3.962082963689492*^9, 
  3.96208297621413*^9}, {3.962084879796434*^9, 3.9620848803904543`*^9}, {
  3.962085284933755*^9, 3.9620852854120827`*^9}, {3.96208545066746*^9, 
  3.962085451192596*^9}, {3.962085552772203*^9, 3.962085567016952*^9}, {
  3.9620856443085938`*^9, 3.962085644762024*^9}, {3.962085995551882*^9, 
  3.9620859960122843`*^9}, {3.962086123780551*^9, 3.962086124098853*^9}},
 CellLabel->
  "In[275]:=",ExpressionUUID->"be8bd781-ab27-45ee-8929-f4962a74a384"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    FractionBox[
     RowBox[{
      FractionBox["1", "2"], "+", 
      FractionBox["\[ImaginaryI]", "2"]}], 
     SqrtBox["2"]], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"-", 
     FractionBox[
      RowBox[{"\[ImaginaryI]", "+", 
       SuperscriptBox["\[ExponentialE]", 
        RowBox[{"\[ImaginaryI]", " ", 
         SuperscriptBox["2", 
          RowBox[{"1", "-", "n"}]], " ", "\[Pi]"}]]}], 
      RowBox[{"2", " ", 
       SqrtBox["2"]}]]}], "}"}], ",", 
   RowBox[{"{", 
    FractionBox[
     RowBox[{
      RowBox[{"-", "\[ImaginaryI]"}], "+", 
      SuperscriptBox["\[ExponentialE]", 
       RowBox[{"\[ImaginaryI]", " ", 
        SuperscriptBox["2", 
         RowBox[{"1", "-", "n"}]], " ", "\[Pi]"}]]}], 
     RowBox[{"2", " ", 
      SqrtBox["2"]}]], "}"}], ",", 
   RowBox[{"{", 
    FractionBox[
     RowBox[{
      FractionBox["1", "2"], "-", 
      FractionBox["\[ImaginaryI]", "2"]}], 
     SqrtBox["2"]], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.962068660459182*^9, 3.9620686702969933`*^9}, {
   3.9620687771256247`*^9, 3.96206878443577*^9}, {3.9620828345315037`*^9, 
   3.96208285251272*^9}, 3.962082923448942*^9, {3.962082964103204*^9, 
   3.962082976553211*^9}, {3.962084875465911*^9, 3.962084880976644*^9}, 
   3.962085213520438*^9, {3.962085274440983*^9, 3.9620852857516003`*^9}, 
   3.962085451438933*^9, {3.9620854976055937`*^9, 3.962085505457014*^9}, {
   3.9620855477538567`*^9, 3.962085567678092*^9}, {3.962085637761798*^9, 
   3.962085645308879*^9}, 3.962085711358408*^9, {3.9620859839496183`*^9, 
   3.9620859966392117`*^9}, 3.962086124297961*^9, 3.962086499800631*^9, 
   3.962086915488326*^9, 3.962087331408841*^9},
 CellLabel->
  "Out[275]=",ExpressionUUID->"18698a49-b009-4fcc-a0d8-5d71b045a78a"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{"rho", "=", 
  RowBox[{"Assuming", "[", 
   RowBox[{
    RowBox[{
     RowBox[{"\[Theta]", "\[Element]", "Reals"}], "&&", 
     RowBox[{"n", "\[Element]", "Reals"}]}], ",", " ", 
    RowBox[{
     RowBox[{"psi", ".", 
      RowBox[{"ConjugateTranspose", "[", "psi", "]"}]}], "//", 
     "FullSimplify"}]}], "]"}]}]], "Input",
 CellChangeTimes->{{3.962084901261201*^9, 3.9620849377796497`*^9}, {
  3.962085005549241*^9, 3.962085078532381*^9}, {3.96208589143994*^9, 
  3.9620859318858*^9}, {3.9620860043558903`*^9, 3.962086005039791*^9}, {
  3.962086509178781*^9, 3.962086518652969*^9}},
 CellLabel->
  "In[268]:=",ExpressionUUID->"59f1b6c3-cf64-45ad-986f-2acc465d225c"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    RowBox[{
     FractionBox["1", "4"], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "8"]}], "-", 
        FractionBox["\[ImaginaryI]", "8"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", 
          SuperscriptBox["2", 
           RowBox[{"1", "-", "n"}]], " ", "\[Pi]"}]]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "8"], "+", 
        FractionBox["\[ImaginaryI]", "8"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"\[ImaginaryI]", "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", 
          SuperscriptBox["2", 
           RowBox[{"1", "-", "n"}]], " ", "\[Pi]"}]]}], ")"}]}], ",", 
     FractionBox["\[ImaginaryI]", "4"]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "8"]}], "+", 
        FractionBox["\[ImaginaryI]", "8"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"\[ImaginaryI]", "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          SuperscriptBox["2", 
           RowBox[{"1", "-", "n"}]], " ", "\[Pi]"}]]}], ")"}]}], ",", 
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "+", 
        RowBox[{"Sin", "[", 
         RowBox[{
          SuperscriptBox["2", 
           RowBox[{"1", "-", "n"}]], " ", "\[Pi]"}], "]"}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"-", 
       FractionBox["1", "4"]}], " ", "\[ImaginaryI]", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        SuperscriptBox["2", 
         RowBox[{"1", "-", "n"}]], " ", "\[Pi]"}], "]"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "8"]}], "-", 
        FractionBox["\[ImaginaryI]", "8"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"\[ImaginaryI]", "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          SuperscriptBox["2", 
           RowBox[{"1", "-", "n"}]], " ", "\[Pi]"}]]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "8"], "-", 
        FractionBox["\[ImaginaryI]", "8"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          SuperscriptBox["2", 
           RowBox[{"1", "-", "n"}]], " ", "\[Pi]"}]]}], ")"}]}], ",", 
     RowBox[{
      FractionBox["1", "4"], " ", "\[ImaginaryI]", " ", 
      RowBox[{"Cos", "[", 
       RowBox[{
        SuperscriptBox["2", 
         RowBox[{"1", "-", "n"}]], " ", "\[Pi]"}], "]"}]}], ",", 
     RowBox[{
      FractionBox["1", "4"], " ", 
      RowBox[{"(", 
       RowBox[{"1", "-", 
        RowBox[{"Sin", "[", 
         RowBox[{
          SuperscriptBox["2", 
           RowBox[{"1", "-", "n"}]], " ", "\[Pi]"}], "]"}]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "8"], "+", 
        FractionBox["\[ImaginaryI]", "8"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{"\[ImaginaryI]", " ", 
          SuperscriptBox["2", 
           RowBox[{"1", "-", "n"}]], " ", "\[Pi]"}]]}], ")"}]}]}], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["\[ImaginaryI]", "4"]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", 
         FractionBox["1", "8"]}], "+", 
        FractionBox["\[ImaginaryI]", "8"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"-", "\[ImaginaryI]"}], "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", 
          SuperscriptBox["2", 
           RowBox[{"1", "-", "n"}]], " ", "\[Pi]"}]]}], ")"}]}], ",", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        FractionBox["1", "8"], "-", 
        FractionBox["\[ImaginaryI]", "8"]}], ")"}], " ", 
      RowBox[{"(", 
       RowBox[{"\[ImaginaryI]", "+", 
        SuperscriptBox["\[ExponentialE]", 
         RowBox[{
          RowBox[{"-", "\[ImaginaryI]"}], " ", 
          SuperscriptBox["2", 
           RowBox[{"1", "-", "n"}]], " ", "\[Pi]"}]]}], ")"}]}], ",", 
     FractionBox["1", "4"]}], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.962085910300068*^9, 3.962085932423203*^9}, {
   3.962086000117519*^9, 3.962086005519985*^9}, 3.962086126084984*^9, {
   3.962086504155942*^9, 3.96208651917712*^9}, 3.962086917170875*^9},
 CellLabel->
  "Out[268]=",ExpressionUUID->"7c433240-6998-4510-b73d-20015b708253"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"{", 
     RowBox[{
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Tr", "[", 
         RowBox[{"X1", ".", "rho"}], "]"}], "//", "Simplify"}], ")"}], ",", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Tr", "[", 
         RowBox[{"Y1", ".", "rho"}], "]"}], "//", "Simplify"}], ")"}], ",", 
      RowBox[{"(", 
       RowBox[{
        RowBox[{"Tr", "[", 
         RowBox[{"Z1", ".", "rho"}], "]"}], "//", "Simplify"}], ")"}]}], 
     "}"}], " ", "//", "FullSimplify"}], ")"}], " "}]], "Input",
 CellChangeTimes->{{3.962085080766425*^9, 3.96208508667106*^9}, {
   3.962085130663005*^9, 3.962085182577368*^9}, {3.9620852940244226`*^9, 
   3.962085303201461*^9}, {3.962085335486742*^9, 3.962085348883872*^9}, {
   3.962085652286313*^9, 3.962085661407414*^9}, {3.962085718226033*^9, 
   3.962085743309698*^9}, {3.962086027935547*^9, 3.96208608634444*^9}, {
   3.962086526419849*^9, 3.962086604190136*^9}, {3.962086920177038*^9, 
   3.96208692031356*^9}, 3.962088312972589*^9},
 CellLabel->
  "In[276]:=",ExpressionUUID->"9322fb69-a4c0-45ab-bf6d-9e1ace2b0115"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "2"]}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{
      SuperscriptBox["2", 
       RowBox[{"1", "-", "n"}]], " ", "\[Pi]"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "2"]}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{
      SuperscriptBox["2", 
       RowBox[{"1", "-", "n"}]], " ", "\[Pi]"}], "]"}]}], ",", 
   RowBox[{
    RowBox[{"-", 
     FractionBox["1", "2"]}], " ", 
    RowBox[{"Sin", "[", 
     RowBox[{
      SuperscriptBox["2", 
       RowBox[{"1", "-", "n"}]], " ", "\[Pi]"}], "]"}]}]}], "}"}]], "Output",
 CellChangeTimes->{{3.962085145050703*^9, 3.9620851830144377`*^9}, {
   3.9620852796744537`*^9, 3.962085300835184*^9}, {3.962085335870633*^9, 
   3.962085349093974*^9}, 3.962085492706704*^9, {3.962085640708961*^9, 
   3.962085662131043*^9}, {3.962085715026103*^9, 3.9620857436613607`*^9}, {
   3.962085905961094*^9, 3.962085935483746*^9}, 3.96208601022789*^9, {
   3.962086040475032*^9, 3.962086086529396*^9}, 3.962086127647088*^9, {
   3.962086521027584*^9, 3.9620866043562403`*^9}, {3.9620869184245*^9, 
   3.962086920548258*^9}, 3.9620872772841177`*^9, 3.9620883134130783`*^9},
 CellLabel->
  "Out[276]=",ExpressionUUID->"d8ca0936-5040-45e1-b7ee-4047a524f77e"]
}, Open  ]],

Cell[BoxData[""], "Input",
 CellChangeTimes->{{3.962085051267124*^9, 
  3.962085053069705*^9}},ExpressionUUID->"81bbc00e-3a6c-4e13-9160-\
1d0e110b3c9e"],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"(", 
   RowBox[{
    RowBox[{"CNOTLSB", ".", "H2", ".", "diagEJM", ".", 
     RowBox[{"Transpose", "[", 
      RowBox[{"{", 
       RowBox[{"Flatten", "[", 
        RowBox[{"KroneckerProduct", "[", 
         RowBox[{"ketp", ",", "ketp"}], "]"}], "]"}], "}"}], "]"}]}], "//", 
    "Simplify"}], " ", ")"}], "/.", 
  RowBox[{"n", "->", "2"}]}]], "Input",
 CellChangeTimes->{{3.962087292598391*^9, 3.9620873045711327`*^9}},
 CellLabel->
  "In[274]:=",ExpressionUUID->"a04b4715-6c48-4212-a0c2-fa953ba4ce6f"],

Cell[BoxData[
 RowBox[{"{", 
  RowBox[{
   RowBox[{"{", 
    FractionBox[
     RowBox[{
      FractionBox["1", "2"], "+", 
      FractionBox["\[ImaginaryI]", "2"]}], 
     SqrtBox["2"]], "}"}], ",", 
   RowBox[{"{", 
    RowBox[{"-", 
     FractionBox["\[ImaginaryI]", 
      SqrtBox["2"]]}], "}"}], ",", 
   RowBox[{"{", "0", "}"}], ",", 
   RowBox[{"{", 
    FractionBox[
     RowBox[{
      FractionBox["1", "2"], "-", 
      FractionBox["\[ImaginaryI]", "2"]}], 
     SqrtBox["2"]], "}"}]}], "}"}]], "Output",
 CellChangeTimes->{{3.962087294590844*^9, 3.962087304906476*^9}},
 CellLabel->
  "Out[274]=",ExpressionUUID->"f0e7bd96-b6be-46ed-ab1b-761ada0eb948"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{
   RowBox[{"-", 
    FractionBox["1", "2"]}], " ", 
   RowBox[{"Sin", "[", 
    RowBox[{
     SuperscriptBox["2", 
      RowBox[{"1", "-", "n"}]], " ", "\[Pi]"}], "]"}]}], "//", 
  "TeXForm"}]], "Input",
 CellChangeTimes->{{3.9620883216722927`*^9, 3.962088341166831*^9}},
 CellLabel->
  "In[278]:=",ExpressionUUID->"21523adb-30e0-45db-a521-acbda55180ea"],

Cell["-\\frac{1}{2} \\sin \\left(\\pi  2^{1-n}\\right)", "Output",
 CellChangeTimes->{{3.96208833695538*^9, 3.962088341461638*^9}},
 CellLabel->
  "Out[278]//TeXForm=",ExpressionUUID->"af888210-53bb-435f-b45c-06f40a63849c"]
}, Open  ]],

Cell[CellGroupData[{

Cell[BoxData[
 RowBox[{
  RowBox[{"{", 
   RowBox[{
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SuperscriptBox["2", 
        RowBox[{"1", "-", "n"}]], " ", "\[Pi]"}], "]"}]}], ",", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SuperscriptBox["2", 
        RowBox[{"1", "-", "n"}]], " ", "\[Pi]"}], "]"}]}], ",", 
    RowBox[{
     RowBox[{"-", 
      FractionBox["1", "2"]}], " ", 
     RowBox[{"Sin", "[", 
      RowBox[{
       SuperscriptBox["2", 
        RowBox[{"1", "-", "n"}]], " ", "\[Pi]"}], "]"}]}]}], "}"}], "//", 
  "TeXForm"}]], "Input",
 CellChangeTimes->{{3.96208839488237*^9, 3.9620884035405397`*^9}},
 CellLabel->
  "In[280]:=",ExpressionUUID->"1363e020-b1c7-43d6-8402-d5fe70afa18d"],

Cell["\<\
\\left\\{-\\frac{1}{2} \\sin \\left(\\pi  2^{1-n}\\right),-\\frac{1}{2} \\sin \
\\left(\\pi 
   2^{1-n}\\right),-\\frac{1}{2} \\sin \\left(\\pi  2^{1-n}\\right)\\right\\}\
\
\>", "Output",
 CellChangeTimes->{{3.962088399213039*^9, 3.962088403717699*^9}},
 CellLabel->
  "Out[280]//TeXForm=",ExpressionUUID->"f5f9e03d-3609-471e-b326-d7dc4d27d9a5"]
}, Open  ]]
},
WindowSize->{808, 890},
WindowMargins->{{Automatic, 336}, {-12, Automatic}},
FrontEndVersion->"13.3 for Mac OS X ARM (64-bit) (July 24, 2023)",
StyleDefinitions->"Default.nb",
ExpressionUUID->"296daf22-1d4a-47a4-affc-2180256d355c"
]
(* End of Notebook Content *)

(* Internal cache information *)
(*CellTagsOutline
CellTagsIndex->{}
*)
(*CellTagsIndex
CellTagsIndex->{}
*)
(*NotebookFileOutline
Notebook[{
Cell[CellGroupData[{
Cell[580, 22, 489, 13, 30, "Input",ExpressionUUID->"34db9da3-983b-4a94-a6c3-df907fe63086"],
Cell[1072, 37, 496, 13, 34, "Output",ExpressionUUID->"311efff5-65a3-451c-b2e4-a408cca13414"]
}, Open  ]],
Cell[1583, 53, 1608, 46, 136, "Input",ExpressionUUID->"5b37f87b-29c9-4f11-90d5-867613f30bea"],
Cell[3194, 101, 151, 3, 30, "Input",ExpressionUUID->"888a22e9-30b3-425e-b831-5158efb370c7"],
Cell[CellGroupData[{
Cell[3370, 108, 849, 24, 30, "Input",ExpressionUUID->"006785a4-40f8-46b0-8089-6127000fdfc3"],
Cell[4222, 134, 1200, 35, 47, "Output",ExpressionUUID->"f89f10c9-3f8e-436c-872f-b556eb0e0e34"]
}, Open  ]],
Cell[CellGroupData[{
Cell[5459, 174, 638, 14, 30, "Input",ExpressionUUID->"529f298b-2b0c-4db1-a761-a26d019a3a9a"],
Cell[6100, 190, 660, 16, 34, "Output",ExpressionUUID->"51055a5c-2e7d-442e-8a72-5294d9de940e"]
}, Open  ]],
Cell[CellGroupData[{
Cell[6797, 211, 866, 21, 30, "Input",ExpressionUUID->"7a1f70d3-b2cc-4006-9c11-15a399f1dd6d"],
Cell[7666, 234, 817, 21, 44, "Output",ExpressionUUID->"c8713d5c-a381-415d-b177-0241db33a0f4"]
}, Open  ]],
Cell[CellGroupData[{
Cell[8520, 260, 1110, 21, 52, "Input",ExpressionUUID->"be8bd781-ab27-45ee-8929-f4962a74a384"],
Cell[9633, 283, 1798, 46, 62, "Output",ExpressionUUID->"18698a49-b009-4fcc-a0d8-5d71b045a78a"]
}, Open  ]],
Cell[CellGroupData[{
Cell[11468, 334, 691, 16, 30, "Input",ExpressionUUID->"59f1b6c3-cf64-45ad-986f-2acc465d225c"],
Cell[12162, 352, 5028, 149, 163, "Output",ExpressionUUID->"7c433240-6998-4510-b73d-20015b708253"]
}, Open  ]],
Cell[CellGroupData[{
Cell[17227, 506, 1130, 27, 52, "Input",ExpressionUUID->"9322fb69-a4c0-45ab-bf6d-9e1ace2b0115"],
Cell[18360, 535, 1305, 33, 49, "Output",ExpressionUUID->"d8ca0936-5040-45e1-b7ee-4047a524f77e"]
}, Open  ]],
Cell[19680, 571, 152, 3, 30, "Input",ExpressionUUID->"81bbc00e-3a6c-4e13-9160-1d0e110b3c9e"],
Cell[CellGroupData[{
Cell[19857, 578, 538, 14, 52, "Input",ExpressionUUID->"a04b4715-6c48-4212-a0c2-fa953ba4ce6f"],
Cell[20398, 594, 662, 22, 62, "Output",ExpressionUUID->"f0e7bd96-b6be-46ed-ab1b-761ada0eb948"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21097, 621, 389, 12, 46, "Input",ExpressionUUID->"21523adb-30e0-45db-a521-acbda55180ea"],
Cell[21489, 635, 223, 3, 48, "Output",ExpressionUUID->"af888210-53bb-435f-b45c-06f40a63849c"]
}, Open  ]],
Cell[CellGroupData[{
Cell[21749, 643, 845, 28, 46, "Input",ExpressionUUID->"1363e020-b1c7-43d6-8402-d5fe70afa18d"],
Cell[22597, 673, 356, 8, 66, "Output",ExpressionUUID->"f5f9e03d-3609-471e-b326-d7dc4d27d9a5"]
}, Open  ]]
}
]
*)

